# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
geom_abline(intercept = 0.195, slope = -0.03),
geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
# geom_smooth(
#     data = filter(rmse_data, order == 2),
#     formula = y ~ splines::ns(x, 3), method = "lm", se = FALSE),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
geom_abline(intercept = 0.195, slope = -0.035),
geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
# geom_smooth(
#     data = filter(rmse_data, order == 2),
#     formula = y ~ splines::ns(x, 3), method = "lm", se = FALSE),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
# geom_smooth(
#     data = filter(rmse_data, order == 2),
#     formula = y ~ splines::ns(x, 3), method = "lm", se = FALSE),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::ns(x, 3), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::ns(x, 2), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
# data = filter(rmse_data, order == 2),
formula = y ~ splines::ns(x, 3), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::ns(x, 3), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::ns(x, 4), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::bs(x, 4), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::bs(x, 3), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::bs(x, 4), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::bs(x, 5), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
attr(splines::bs(rmse_data$fc, 5), "knots")
splines::bs(rmse_data$fc, 5)
attr(splines::bs(rmse_data$fc, 5), "knots")
attr(splines::bs(rmse_data$fc, 3), "knots")
attr(splines::bs(rmse_data$fc, 2), "knots")
ggplot(rmse_data) +
{list( ## Settings
aes(x = fc, y = RMSE,
group = order,
colour = factor(order)),
# facet_wrap(~ order),
coord_cartesian(
xlim = c(0, NA),
ylim = c(0, 0.5)
),
theme_mNIRS(border = "full"),
scale_x_continuous(
name = "Critical Frequency (Hz)",
breaks = scales::breaks_pretty(n=8),
expand = expansion(mult = c(0.0, 0.03))),
scale_y_continuous(
name = "RMSE",
expand = expansion(mult = c(0.0, 0.03))),
NULL)} + ## Settings
{list( ## Data
# geom_abline(intercept = 0.195, slope = -0.035),
# geom_abline(intercept = 0.195, slope = 0, linetype = "dotted"),
geom_line(),
geom_smooth(
data = filter(rmse_data, order == 2),
formula = y ~ splines::ns(x, 5), method = "lm", se = FALSE,
colour = "black"),
geom_point(),
NULL)} ## Data
attr(splines::bs(rmse_data$fc, 5), "knots")
ggplot(df) +
aes(x = time) +
theme_mNIRS() +
scale_x_continuous(
name = "index",
expand = expansion(mult = 0.01)) +
scale_y_continuous(
name = "nirs",
expand = expansion(mult = 0.01)) +
geom_line(aes(y = VL_HHb), alpha = 0.15) +
geom_line(aes(y = `0.025`, colour = "0.025"), linewidth = 1) +
geom_line(aes(y = `0.05`, colour = "0.05"), linewidth = 1) +
geom_line(aes(y = `0.19`, colour = "0.19"), linewidth = 1)
df <-
oxy_data |>
mutate(
across(any_of(nirs_columns),
\(.x) filter_data(.x,
method = "butter",
type = "low",
n = 2,
critical_frequency = 0.025,
sample_rate = sample_rate),
.names = "0.025"),
across(any_of(nirs_columns),
\(.x) filter_data(.x,
method = "butter",
type = "low",
n = 2,
critical_frequency = 0.05,
sample_rate = sample_rate),
.names = "0.05"),
across(any_of(nirs_columns),
\(.x) filter_data(.x,
method = "butter",
type = "low",
n = 2,
critical_frequency = 0.19,
sample_rate = sample_rate),
.names = "0.19"),
)
ggplot(df) +
aes(x = time) +
theme_mNIRS() +
scale_x_continuous(
name = "index",
expand = expansion(mult = 0.01)) +
scale_y_continuous(
name = "nirs",
expand = expansion(mult = 0.01)) +
geom_line(aes(y = VL_HHb), alpha = 0.15) +
geom_line(aes(y = `0.025`, colour = "0.025"), linewidth = 1) +
geom_line(aes(y = `0.05`, colour = "0.05"), linewidth = 1) +
geom_line(aes(y = `0.19`, colour = "0.19"), linewidth = 1)
ggplot(df) +
aes(x = time) +
theme_mNIRS() +
scale_x_continuous(
name = "index",
expand = expansion(mult = 0.01)) +
scale_y_continuous(
name = "nirs",
expand = expansion(mult = 0.01)) +
geom_line(aes(y = VL_HHb), alpha = 0.15) +
# geom_line(aes(y = `0.025`, colour = "0.025"), linewidth = 1) +
geom_line(aes(y = `0.062`, colour = "0.062"), linewidth = 1) +
geom_line(aes(y = `0.19`, colour = "0.19"), linewidth = 1)
df <-
oxy_data |>
mutate(
across(any_of(nirs_columns),
\(.x) filter_data(.x,
method = "butter",
type = "low",
n = 2,
critical_frequency = 0.025,
sample_rate = sample_rate),
.names = "0.025"),
across(any_of(nirs_columns),
\(.x) filter_data(.x,
method = "butter",
type = "low",
n = 2,
critical_frequency = 0.062,
sample_rate = sample_rate),
.names = "0.062"),
across(any_of(nirs_columns),
\(.x) filter_data(.x,
method = "butter",
type = "low",
n = 2,
critical_frequency = 0.19,
sample_rate = sample_rate),
.names = "0.19"),
)
ggplot(df) +
aes(x = time) +
theme_mNIRS() +
scale_x_continuous(
name = "index",
expand = expansion(mult = 0.01)) +
scale_y_continuous(
name = "nirs",
expand = expansion(mult = 0.01)) +
geom_line(aes(y = VL_HHb), alpha = 0.15) +
# geom_line(aes(y = `0.025`, colour = "0.025"), linewidth = 1) +
geom_line(aes(y = `0.062`, colour = "0.062"), linewidth = 1) +
geom_line(aes(y = `0.19`, colour = "0.19"), linewidth = 1)
#| context: setup
## install latest private repo from github
devtools::install_github(
"jemarnold/mNIRS",
auth_token = "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")
#| context: setup
## install latest private repo from github
devtools::install_github(
"jemarnold/mNIRS",
auth_token = "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")
#| context: setup
## install latest private repo from github
devtools::install_github(
"jemarnold/mNIRS",
upgrade = "never",
auth_token = "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")
#| context: setup
## install latest private repo from github
devtools::install_github(
"jemarnold/mNIRS",
upgrade = "never",
auth_token = "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")
remove.packages("mNIRS")
#| context: setup
## install latest private repo from github
devtools::install_github(
"jemarnold/mNIRS",
upgrade = "never",
auth_token = "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")
